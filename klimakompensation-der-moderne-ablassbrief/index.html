<!DOCTYPE html><html lang="de"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>CO2-Kompensation - moderner Ablasshandel oder eine gute Alternative? - crichardt.com</title><meta name="description" content="Handelt es sich bei CO2 Kompensation um eine Gewissensberuhigung oder tatäschlich um eine sinnvolle Maßnahme?"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://crichardt.com/klimakompensation-der-moderne-ablassbrief/"><meta property="og:title" content="CO2-Kompensation - moderner Ablasshandel oder eine gute Alternative?"><meta property="og:image" content="https://crichardt.com/media/posts/22/IMGP5024.jpg"><meta property="og:site_name" content="crichardt.com"><meta property="og:description" content="Handelt es sich bei CO2 Kompensation um eine Gewissensberuhigung oder tatäschlich um eine sinnvolle Maßnahme?"><meta property="og:url" content="https://crichardt.com/klimakompensation-der-moderne-ablassbrief/"><meta property="og:type" content="article"><link rel="alternate" type="application/atom+xml" href="https://crichardt.com/feed.xml"><link rel="alternate" type="application/json" href="https://crichardt.com/feed.json"><link rel="shortcut icon" href="https://crichardt.com/media/website/logo.png" type="image/png"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700&amp;subset=latin-ext&amp;display=swap" rel="stylesheet"><style>h1,h2,h3,h4,h5,h6,blockquote,.logo,.footer__logo,.dropcap::first-letter ,.search__input{font-family:'Playfair Display',serif}body,.btn,[type=button],[type=submit],button,.navbar__menu,.footer{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://crichardt.com/assets/css/style.css?v=75ab75562fe124ba4404e5d93c1b7120"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://crichardt.com/klimakompensation-der-moderne-ablassbrief/"},"headline":"CO2-Kompensation - moderner Ablasshandel oder eine gute Alternative?","datePublished":"2019-09-30T21:29","dateModified":"2020-02-25T18:41","image":{"@type":"ImageObject","url":"https://crichardt.com/media/posts/22/IMGP5024.jpg","height":4912,"width":7360},"description":"Handelt es sich bei CO2 Kompensation um eine Gewissensberuhigung oder tatäschlich um eine sinnvolle Maßnahme?","author":{"@type":"Person","name":"Clemens Richardt","url":"https://crichardt.com/autor/clemens-richardt/"},"publisher":{"@type":"Organization","name":"Clemens Richardt","logo":{"@type":"ImageObject","url":"https://crichardt.com/media/website/CR_light-klein-no-border.png","height":200,"width":306}}}</script></head><body><header class="header" id="js-header"><div><a class="logo" href="https://crichardt.com/"><img src="https://crichardt.com/media/website/CR_light-klein-no-border.png" alt="crichardt.com"></a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul id="js-navbar-menu" class="navbar__menu"><li><a href="https://crichardt.com/tag/ethical_business/" target="_self">Ethical Business</a></li><li class="has-submenu"><a href="https://crichardt.com/tag/fotografie/" target="_self" aria-haspopup="true">Fotografie</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://crichardt.com/tag/dslr/" target="_self">DSLR Fotografie</a></li></ul></li><li><a href="https://travel.crichardt.com/" title="https://crichardt.com/travel/" target="_self">Travel</a></li><li><a href="https://crichardt.com/autor/clemens-richardt/" target="_self">Über mich</a></li><li><a href="https://crichardt.com/impressum/" title="Impressum" target="_self">Impressum</a></li><li><a href="https://crichardt.com/datenschutz/" target="_self">Datenschutz</a></li></ul></nav><div class="search"><div class="search__overlay" id="js-search-overlay"><div><form action="https://crichardt.com/search.html" class="search__form"><input class="search__input" id="js-search-input" type="search" name="q" placeholder="search..." aria-label="Search input" autofocus="autofocus"></form><button class="search__close" id="js-search-close" aria-label="Close">Close</button></div></div><button class="search__btn" id="js-search-btn" aria-label="Search"><svg class="icon" role="presentation" focusable="false"><use xlink:href="https://crichardt.com/assets/svg/svg-map.svg#search"/></svg></button></div></div></header><article><div class="hero"><div class="hero__wrapper"><figure class="hero__image hero__image--overlay"><img src="https://crichardt.com/media/posts/22/IMGP5024.jpg" srcset="https://crichardt.com/media/posts/22/responsive/IMGP5024-xs.jpg 300w, https://crichardt.com/media/posts/22/responsive/IMGP5024-sm.jpg 480w, https://crichardt.com/media/posts/22/responsive/IMGP5024-md.jpg 749w, https://crichardt.com/media/posts/22/responsive/IMGP5024-xl.jpg 1200w, https://crichardt.com/media/posts/22/responsive/IMGP5024-xxl.jpg 1600w, https://crichardt.com/media/posts/22/responsive/IMGP5024-xxxl.jpg 2560w" sizes="(max-width: 2560px) 100vw, 2560px" loading="eager" height="4912" width="7360" alt="Calgary, Road to Downtown"><figcaption>©2019 Clemens Richardt</figcaption></figure><div class="hero__inner"><h1 class="hero__title">CO2-Kompensation - moderner Ablasshandel oder eine gute Alternative?</h1><div class="post__meta"><a href="https://crichardt.com/autor/clemens-richardt/" class="post__meta-author" title="Clemens Richardt"><img src="https://crichardt.com/media/website/IMGP2992.jpg" loading="eager" alt="Clemens Richardt"> By Clemens Richardt </a><time datetime="2019-09-30T21:29" class="page__item-date">30/09/2019 </time><a href="https://crichardt.com/tag/ethical_business/" class="post__meta-category">Ethical Business</a></div></div></div></div><div class="main"><div class="wrapper"><div class="page post"><div class="post__inner"><div class="post__entry"><p class="dropcap">Aktuell verspricht Volkswagen als einer der ersten Autohersteller mit dem ID.3 ein "bilanziell" CO2 neutrales Fahrzeug, solange mit Ökostrom getankt wird. Auch soll bei der Produktion des Fahrzeugs und der Akkuzellen Ökostrom verwendet werden. Doch da auch VW nicht verhindern kann, dass bei der Produktion und Verarbeitung von Stahl und anderen Materialien CO2 Emissionen anfallen, kann das nicht so ganz stimmen. Wie also löst VW dieses Problem?</p><blockquote><p>Sind doch einmal entlang der Lieferkette CO2-Emissionen unvermeidlich, dann werden diese durch Investitionen in Klimaschutzprojekte kompensiert.</p></blockquote><p>Dieses Zitat stammt aus einer <a href="https://uploads.volkswagen-newsroom.com/system/production/uploaded_files/14975/file/94143783ed3e4223df29611f3efcc800eacf4cba/Der_ID_3_Aufbruch_in_eine_neue_Aera.pdf?1568109216" target="_blank" rel="noopener noreferrer">Medieninformation von VW</a> zum ID.3. Auch Volkswagen kann also nicht zaubern, gibt uns aber den perfekten Anlass, die Klimakompensation, wie sie auch für Privatpersonen angeboten wird, mal genauer zu betrachten. Also wollen wir doch zuerst mal einen groben Blick auf die Funktionsweise der CO2 Kompensation werfen.</p><h2>1. Berechnung der Emissionen</h2><p>Bevor ich etwas kompensieren kann, muss ich das Ausmaß meiner Emissionen für die zu kompensierende Sache möglichst genau kennen. Dafür bieten einige Anbieter für die gängigen Vorgänge wie Flüge, Autofahrten, etc sehr genaue Berechnungstools an. Für andere Dinge, wie die Produktion von Industriegütern, ist meist eine genauere Betrachtung des Prozesses notwendig. Einige Anbieter bieten aber auch ein Berechnungstool Anhand verschiedener Kriterien an.</p><h2>2. Maßnahmen</h2><p>Grundsätzlich lassen sich die Maßnahmen, mit denen die Anbieter (beispielsweise Atmosfair, Climatefair, Klima-kollekte und Primaklima) die CO2-Emissionen ausgleichen wollen, in vier Kategorien unterteilen. Alle haben letztlich die Einsparung von CO2 Emissionen an anderen Orten zum Ziel.</p><h4>Energieeffizienz</h4><p>Im Bereich der Energieeffizienz handelt es sich bei vielen Projekten um Maßnahmen zur Einsparung von Feuerholz in sehr armen Entwicklungsländern. Mit effizienten Holzöfen kann die Abholzung von Wäldern eingedämmt werden. Gleichzeitig haben diese Öfen den positiven Effekt, dass die gesundheitliche Belastung durch Rauch zurückgeht und oft sogar ein finanzieller Vorteil für die Anwender besteht. Allerdings gibt es durchaus auch Projekte, die durch effiziente Beleuchtung in Deutschland Strom einsparen.</p><h4>Energieerzeugung</h4><p>Die Förderung von Windkraft, Solarthermie, Photovoltaik und Biogas, bevorzugt in Ländern, in denen diese noch nicht bekannt oder verbreitet sind, beschreibt die zweite Art von Projekten zur Kompensation. </p><h4>Aufforstung</h4><p>Durch das Anlegen und Erhalten von Wäldern wird viel CO2 aus der Atmosphäre gezogen und gespeichert. Zusätzlich haben diese Projekte oft auch einen positiven Einfluss auf die Regionen, in denen sie durchgeführt werden. So entstehen Arbeitsplätze in meist wirtschaftlich schwachen Regionen, Früchte und andere Produkte entstehen als Nebenprodukt und tragen zur Ernährung bei. </p><h4>Bildung </h4><p>Als Unterrichtseinheiten an Schulen oder ähnliche Arten der Wissensvermittlung sollen Menschen dazu bewegt werden, durch bewusstes Handeln CO2 Emissionen einzusparen. Emissionen, die gar nicht erst entstehen, müssen schlussendlich auch nicht kompensiert werden. </p><h2>Positive Auswirkungen </h2><p>Neben der offensichtlichen positiven Auswirkungen, die durch die Projekte erreicht werden, gibt es natürlich auch noch weitere Auswirkungen. Für Unternehmen liegen diese zum einen im Bereich Marketing. Denn wenn ein Unternehmen damit werben kann, Klimaneutral zu handeln, hat das nicht nur Vorteile im Endkundenbereich, wo eine deutlich größere Zielgruppe angesprochen werden kann, sondern auch im B2B Bereich, da Unternehmen - wie z.B. VW im Beispiel zu Beginn - natürlich lieber den Anbieter wählen, der schon weniger CO2 ausstößt, um nachher Kosten bei der Kompensation zu sparen. Auch auf dem Arbeitsmarkt wird es für eine wachsende Anzahl von potenziellen Mitarbeitern immer wichtiger, in einem Unternehmen mit positivem Einfluss auf das Klima zu arbeiten. Gerade in Zeiten des Fachkräftemangels in vielen Branchen kann das den entscheidenden Unterschied machen. Auch eine wachsende Zahl von Banken achtet darauf, wie das Geld der Kunden investiert wird. Beispiele sind hier zum Beispiel die DKB oder das Start-Up Tomorrow.</p><h2>Negative Auswirkungen</h2><p>Natürlich hat die CO2 Kompensation auch negative Auswirkungen. So lädt eine Kompensation grundsätzlich dazu ein, diese in die Kosten mit einzukalkulieren und einfach so weiter zu machen, wie zuvor. Für Unternehmen bzw. deren Mitarbeiter kann dadurch die Meinung entstehen, dass "ja eh kompensiert wird, also muss ich jetzt auch nicht mehr einsparen". Auch wird ggf. mit den Kompensationen in Wirtschaftssysteme von Entwicklungsländern eingegriffen, ähnlich der Problematik mit Kleiderspenden oder billigen Hühnerfüßen, die nach Afrika exportiert werden und den lokalen Markt unter Druck setzen.</p><h2>Fazit</h2><p>Für Unternehmen und Privatpersonen gilt nach wie vor, dass eine nicht produzierte CO2 Emission die beste ist. Doch natürlich können nicht alle Emissionen verhindert werden. Daher ist es definitiv gut, wenn wir Emissionen kompensieren, anstatt gar nichts zu unternehmen. Gleichzeitig steigert die CO2 Kompensation auch das Bewusstsein im Unternehmen für die Problematik. Solange die CO2 Kompensation also nicht als einziges Instrument zur Verringerung der Emissionen genutzt wird, ist sie definitiv zu empfehlen. Durch die weitere Reduzierung von Emissionen wird anschließend auch die Kompensation mit der Zeit geringer.</p><p> </p><p> </p></div><footer><div class="post__updated">Updated: <time datetime="2020-02-25T18:41">25/02/2020</time></div><ul class="post__tag"><li><a href="https://crichardt.com/tag/ethical_business/" title="Ethical Business" class="invert">Ethical Business</a></li></ul><div class="post__share"></div><div class="post__bio"><img src="https://crichardt.com/media/website/IMGP2992.jpg" loading="lazy" alt="Clemens Richardt"><div><h3 class="h5"><a href="https://crichardt.com/autor/clemens-richardt/" title="Clemens Richardt" class="invert">Clemens Richardt</a></h3><p>Offensichtlich an den Themen Nachhaltigkeit und Fotografie interessiert. Darüber hinaus für vieles aus der Technikwelt zu begeistern. Wenn die Zeit und Muse vorhanden ist, schreibe ich hier und hoffe dir sowie der Umwelt eine Hilfe zu sein.</p></div></div><nav class="post__nav" id="js-post__nav"><div class="post__nav__prev"><a href="https://crichardt.com/klimaschutz-fur-schwachkopfe-oder/" rel="prev" class="post__nav__link"><img src="https://crichardt.com/media/posts/24/responsive/IMGP1173-xs.jpg" loading="lazy" height="4912" width="7360" alt="Corn field"><div class="post__nav__text">Prev:<h5 class="invert">Klimaschutz ist nur für Schwachköpfe von Greenpeace! - Oder?</h5></div></a></div><div class="post__nav__next"><a href="https://crichardt.com/schau-in-die-vergangenheit-und-du-siehst-die-zukunft/" rel="next" class="post__nav__link"><div class="post__nav__text">Next:<h5 class="invert">Schau in die Vergangenheit und du siehst die Zukunft!</h5></div><img src="https://crichardt.com/media/posts/21/responsive/IMGP0646-xs.jpg" loading="lazy" height="4912" width="7360" alt="CR Black and White"></a></div></nav></footer><div class="comments"><div class="comments__inner"><h3 class="h4">Comments</h3><div id="disqus_thread"></div><script>var disqus_config = function () {
                                      this.page.url = 'https://crichardt.com/klimakompensation-der-moderne-ablassbrief/';
                              		this.page.identifier = '22';
                                  };
                              
                                  var disqus_loaded = false;
                              
                                  function publiiLoadDisqus() {
                                      if(disqus_loaded) {
                                          return false;
                                      }
                              
                                      var top = document.getElementById('disqus_thread').offsetTop;
                              
                                      if (!disqus_loaded && (window.scrollY || window.pageYOffset) + window.innerHeight > top) {
                                          disqus_loaded = true;
                              
                                          (function () {
                                              var d = document, s = d.createElement('script');
                                              s.src = 'https://crichardt-com.disqus.com/embed.js';
                                              s.setAttribute('data-timestamp', +new Date());
                                              (d.head || d.body).appendChild(s);
                                          })();
                                      }
                                  }
                              
                                  publiiLoadDisqus();
                              
                                  window.onscroll = function() {
                                      publiiLoadDisqus();
                                  };</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div></div></div><div class="page post__related"><h3 class="h4">Similar posts:</h3><div class="post__related__wrap"><figure><a href="https://crichardt.com/klimaschutz-fur-schwachkopfe-oder/"><img src="https://crichardt.com/media/posts/24/responsive/IMGP1173-xs.jpg" loading="lazy" height="4912" width="7360" alt="Corn field"></a><figcaption><h4 class="h6"><a href="https://crichardt.com/klimaschutz-fur-schwachkopfe-oder/" class="invert">Klimaschutz ist nur für Schwachköpfe von Greenpeace! - Oder?</a></h4></figcaption></figure></div></div></div></div></article><div class="bottom-news"><div class="wrapper wrapper--full"><ul class="bottom-news__wrapper"></ul></div></div><footer class="footer"><div class="wrapper"><a class="footer__logo" href="https://crichardt.com/"><img src="https://crichardt.com/media/website/CR_light-klein-no-border.png" alt="crichardt.com"></a><div class="footer__copy">© 2019 CLEMENS RICHARDT</div></div><button class="footer__bttop js-footer__bttop" aria-label="Back to top"><svg><title>Back to top</title><use xlink:href="https://crichardt.com/assets/svg/svg-map.svg#toparrow"/></svg></button></footer><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth:'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'#js-header',};</script><script defer="defer" src="https://crichardt.com/assets/js/scripts.min.js?v=d79800375395a7ef07fbb24142e943e9"></script><script>/*<![CDATA[*/var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};/*]]>*/</script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner"><div class="pcb__inner"><div id="pcb-title" role="heading" class="pcb__title">Diese Website nutzt Cookies.</div><div id="pcb-txt" class="pcb__txt">Wählen Sie über die unten stehenden Kontrollkästchen aus, welche Cookies Sie zulassen möchten. Diese Website verwendet Cookies, um den Datenverkehr und die Nutzeraktivitäten auf unserer Website zu untersuchen, für Marketingzwecke und zur Bereitstellung von Social-Media-Funktionen. <a href="https://crichardt.com/datenschutz/">More details...</a></div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--link pcb__btn--configure" aria-haspopup="dialog">Manage preferences</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject non essential</button> <button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button></div></div></div><div class="pcb__popup" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-popup-title"><div class="pcb__popup__wrapper"><div class="pcb__inner pcb__popup__inner"><div class="pcb__popup__heading"><div id="pcb-popup-title" role="heading" class="pcb__title">Cookie settings</div><button class="pcb__popup__close" aria-label="Close"></button></div><div class="pcb__popup__content"><div class="pcb__txt pcb__popup__txt">We use cookies to enhance your browsing experience, serve personalized ads or content, and analyze our traffic. By clicking "Accept All", you consent to our use of cookies. <a href="https://crichardt.com/datenschutz/">More details...</a></div><ul class="pcb__groups"><li class="pcb__group"><details><summary class="pcb__group__title no-desc">Required</summary></details><div class="pcb__popup__switch is-checked"><input type="checkbox" data-group-name="" id="pcb-group-0" checked="checked"> <label for="pcb-group-0">Required</label></div></li><li class="pcb__group"><details><summary class="pcb__group__title no-desc">Functionality</summary></details><div class="pcb__popup__switch"><input type="checkbox" data-group-name="functions" id="functions-cookies"> <label for="functions-cookies">Functionality</label></div></li><li class="pcb__group"><details><summary class="pcb__group__title no-desc">Analytical</summary></details><div class="pcb__popup__switch"><input type="checkbox" data-group-name="analytics" id="analytics-cookies"> <label for="analytics-cookies">Analytical</label></div></li><li class="pcb__group"><details><summary class="pcb__group__title no-desc">Marketing</summary></details><div class="pcb__popup__switch"><input type="checkbox" data-group-name="marketing" id="marketing-cookies"> <label for="marketing-cookies">Marketing</label></div></li></ul></div><div class="pcb__buttons pcb__popup__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject all</button> <button type="button" class="pcb__btn pcb__btn--save">Save settings</button></div></div></div></div><div class="pcb__overlay" aria-hidden="true"></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('🍪 Config not found, or configuration expired');
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('🍪 Config founded');
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('🍪 Allowed group: ' + allowedGroup);
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('🍪 Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('🍪 Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>